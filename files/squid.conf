# /etc/squid/squid.conf
# Purpose: Local-only HTTP proxy for OHP. Allows CONNECT only to SSH/Dropbear/OpenVPN.
# Listen only on loopback (not exposed on the Internet)
http_port 127.0.0.1:3128
# Hostname shown in logs
visible_hostname localhost
# --------------------------
# Access Control Lists (ACL)
# --------------------------
# Local machine
acl localhost src 127.0.0.1/32 ::1
# Ports we consider safe to talk to (include 80/443 just in case)
acl Safe_ports port 22 109 1194 80 443
# Ports allowed for CONNECT tunneling
acl SSL_ports port 22 109 1194 443
# HTTP CONNECT method
acl CONNECT method CONNECT
# --------------------------
# Access rules
# --------------------------
# Deny requests to any port not in Safe_ports
http_access deny !Safe_ports
# Allow CONNECT only to SSL_ports list
http_access deny CONNECT !SSL_ports
# Allow requests coming from the local machine
http_access allow localhost
# Block everything else
http_access deny all
# --------------------------
# Optional tweaks
# --------------------------
# Prefer IPv4 DNS first (helps on some VPS setups)
dns_v4_first on